# -*- coding: utf-8 -*-
"""Clean_UCI_Dataset.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1I-6rEQ7WJfBuhXT60TOFaXw81oWvrOLP
"""

#Import the Libraries

import pandas as pd
import numpy as np
from google.colab import files

# Loading the UCI dataset

train_url = "https://archive.ics.uci.edu/ml/machine-learning-databases/adult/adult.data"
test_url = "https://archive.ics.uci.edu/ml/machine-learning-databases/adult/adult.test"

# Column names of the dataset

columns = [
    "age", "workclass", "fnlwgt", "education", "education-num", "marital-status",
    "occupation", "relationship", "race", "sex", "capital-gain", "capital-loss",
    "hours-per-week", "native-country", "income"
]

# Load the training set and test set

train_df = pd.read_csv(train_url, names=columns, sep=',', skipinitialspace=True)
test_df = pd.read_csv(test_url, names=columns, sep=',', skipinitialspace=True, skiprows=1)

# Combine the data for cleaning
df = pd.concat([train_df, test_df], ignore_index=True)

# Inspecting the data
print("Original dataset shape:", df.shape)
print(df.head())
print(df.info())

# Handling the missing values

df.replace ('?', np.nan, inplace=True)
# Removing rows with missing values
df.dropna(inplace=True)
print("Shape after dropping the missing values", df.shape)

# Save the cleaned dataset

cleaned_filename = "adult_cleaned.csv"
df.to_csv(cleaned_filename, index=False)

print(f"Cleaned dataset saves as'{cleaned_filename}'")

files.download(cleaned_filename)